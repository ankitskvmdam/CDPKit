/* 
 * BindingAffinityCalculator.cpp 
 *
 * This file is part of the Chemical Data Processing Toolkit
 *
 * Copyright (C) 2003 Thomas Seidel <thomas.seidel@univie.ac.at>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this library; see the file COPYING. If not, write to
 * the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 * Boston, MA 02111-1307, USA.
 */

 
#include "StaticInit.hpp"

#include "CDPL/GRAIL/BindingAffinityCalculator.hpp"
#include "CDPL/GRAIL/GRAILDescriptorCalculator.hpp"


using namespace CDPL;


namespace
{

	double PKI_COEFFS[] = {
	    2.3013658009137337, -0.3670186129581091, 0.045995439426911776, -0.026064720862095957, 0.006768876390667633,
		0.8440826518662876, 0.35168066119533387, 0.3010121332097145, -1.0222896423546056e-13, -0.3881662205560996,
		0.9323494445280346, -0.6240227147711057, 0.12466798571526838, -0.11635209114790661, -0.01296189862493304,
		-0.035680220459776875, 0.15649561463776734, 0.34413200307590736, 0.11386883367095943, 1.087077601503049,
		0.10860187723094215, -0.38037322983721295, 0.015894701243852345, 0.16027260521953932, -0.29833997001981644,
		-0.20203950579589677, -0.015025812383431723, -0.10530319171308838, 0.15910848374855646, 0.0813235992146258,
		-0.1575152545885692, -0.09175180594064233, 0.17802790590693332, -1.2352770858687656, 1.2326985365829959,
		-0.4387884191910591, 0.8123763602243819, 1.7725548700881757, -1.7618032489013025, -0.06276523789899036,
		-0.06275372118323792, -0.18244215063196326, 1.3720741720104612, 0.5579394023505125, -0.41743349933529555,
		0.04325776544002044, -0.1313713768676421, 0.049675231239894674, -0.24585341853812948, 8.994308251513372e-11,
		8.99428899005243e-11, 0.01747042740164658, 0.01746985647778818, -9.562655885176294e-16, 8.728729019547001e-15,
		1.6538939049264616, 0.08969331463278173, 0.9015462827171694, -0.7472995871725672, -3.1515215707543033e-05,
		-3.151521409898983e-05, 0.20941473656796228, 0.1432105435696517, -0.2606354274949061, -0.5721007423532924,
		0.08065848766402323, 0.0806584812876388, 0.017906437089748983, 0.11817354987461146, 1.7188080322189005,
		0.44417796522225156, -0.00022373381482775588, -0.00022319622426443184, -0.6155904133306856, -0.4327854487681968,
		0.3048479642886286, -0.5956070628739756, -0.3984055370338027, -0.39241612700352585, -1.3827434181595404,
		-0.7057056948367482, 0.07695198947123558, 0.40390124776240494, 0.5343527102983192, 0.5305980399780058,
		0.5157714215531535, 0.6960286125855123, 0.49196208702434524, -0.3937069124380953, 1.5110803917339823,
		1.5110804703280243, -0.21082568794266532, 0.42605798605405454, 0.6395135971535291, -0.7361191533450965,
		0.32053859168633925, 0.342519172364839, -0.29675635213217755, 0.41196793158955536, 0.8721230562402236,
		0.2311969103676039, -0.00013930176866254387, -0.0001393017719678669, -0.3221263239225191, -0.31626413949426,
		0.004426136674770844, 0.0044261384019783105, 0.00022570141899918336, 0.00022570984429747513, 9.660871479389948e-06,
		9.660452561852718e-06, 2.1246701016417034e-05, 2.1246698921801266e-05, -9.374011654591525e-16, 5.2244401746919925e-15,
		0.7987409159037488, 0.5591511230255967, 0.4201332052666457, 0.4201335097048738, 1.871736733987571e-06,
		1.871736725123014e-06, -0.274851360357359, -0.2807980266874287, -0.017156124898578637, -0.01715623861453616,
		1.981723366319604e-15, 5.115065157006852e-15, 0.006908904766820335, -0.09763746306643517, -0.7854680305303446,
		0.48641698797117316, -0.00016920826324707343, -0.00016927541128105376, 0.1078101336991941, 0.11517935897676704,
		-0.0008970648224464167, -0.000897473165344774, 9.276862670001549e-13, 9.275847290500377e-13, 0.19847562528360502,
		-0.11754174007764555, -0.15295126372732734, -0.7948168681419779, 0.27145376535540006, 0.27146538294662204,
		1.049801117147717, -1.2344429823630734, 1.825536034894883, -1.678825869122429, 0.4879268800846419,
		0.48792688891842856, 0.8005069923725421, -0.9685832769076641, 0.14442760704132185, -0.6707916140306911,
		0.6397149077618508, 0.639714907733024, -0.6097536488927614, -0.7720718337879142, -0.2113490931743518,
		-0.21134909309230365, -0.0011184654046753465, -0.001118465404621898, -0.048531844561571065, -0.04853186598890835,
		1.4287073583982075e-08, 1.4285388189262567e-08, -9.282686426875927e-16, 9.42809297285643e-16, -0.5570341147363908,
		1.0063630197354854, 0.03867821550373654, -0.14945091151483889, -0.04962501179794998, 0.11577295156497704,
		0.02047741476622205, 0.01965471064059108, -0.0003965825916213914, 0.8440826518658131, -0.043549156309118604,
		0.044780731993806035, 6.936879460594365e-16, 0.11193389997384383, -0.14188338842702147, 0.10724350810608774,
		-0.054032857383082326, -0.004179110351649163, -0.006352096324708106, 0.000577517896244086, 0.2687069550234715,
		0.3441320030758728, 0.007348386569035691, -0.3952607140378058, -0.012383879095246237, 0.12757788045560103,
		-0.00260324791553375, -0.011552583285537366, 0.024893895512742684, 0.10863358648806745, -0.015025812383438308,
		-0.007797107818990766, -0.005438457093823071, -9.269562866666024e-05, 0.0011863447063192257, 0.0020366527173693747,
		-0.005302018382507464, 0.20462479985166587, -0.20953540917453847, 0.054806861797364555, -0.10316269808698149,
		-0.5166505271703753, 0.5190324397796827, -0.2963561310782298, -0.29635517674178136, 0.049243410570213725,
		-0.6341684697517529, -0.15427413694590741, 0.15534009102223625, -0.0005121284118954919, -0.004513464323276083,
		0.004597625584688756, 0.0362039960713235, 3.308062677414983e-19, 7.110993856512926e-20, 0.0007427000211505438,
		0.0007426883612127398, -7.834399154643674e-23, -1.847442048025667e-24, -0.24813592858425504, -0.446917224642959,
		-0.11801224352197558, -0.04889362301649196, -2.065540853180307e-09, -2.06554073750188e-09, -0.21205668168166092,
		0.0044510412512192635, 0.08713551979125655, -0.051796148103492305, 0.002016858860973395, 0.0020168604621405295,
		-0.09853179884820437, 0.25068610195547847, -0.10795902646928464, -1.5394100718799655, -0.020183535478789975,
		-0.0201823667268113, 0.342780737513917, 1.2049309466356777, -0.027652231380377333, 0.11945765671163067,
		0.21301961978903733, 0.3046327128977497, 0.42384791704821284, 1.8438911302285284, 0.022965721006298814,
		-0.13308479218767844, -0.5253020291250023, -0.5280441579797066, -0.6092675591221733, 0.29485081199781515,
		-0.05618411573517551, -0.06557274205514356, -1.1103491139251966, -1.110349183923264, 0.04556159364528702,
		-0.10287377122097294, -0.07768260966799954, 0.11799963175190402, -0.46637425657769116, -0.4208202159898306,
		0.03862305794405398, 0.34819685538555545, -0.06474349215396374, -0.8150591404906498, 5.247766453348772e-06,
		5.247766352856038e-06, -0.18303743971029465, -0.17234688237961365, 0.010257236145179162, 0.010257236104503709,
		4.0762831248015695e-07, 4.0762831787420464e-07, 1.8400907182411546e-09, 1.8400709218123244e-09, 1.0354694376980347e-09,
		1.0354694349304108e-09, 0.0, 0.0, -0.11300459401215943, -0.6649242956432247,
		0.1848719102205108, 0.1848719114277963, 4.5025964377602407e-11, 4.5025964377628534e-11, -0.22320515344850717,
		-0.2247668769523299, -0.0019138352814375768, -0.001913836182012944, -7.17903954134168e-39, -7.17903954134168e-39,
		0.11055843440897828, -0.33391039575809867, -2.172232457828479, 2.396885144336262, -3.9229275510033313e-07,
		-3.922927684430724e-07, 0.2044478729688543, 0.2071198778970179, 1.4288800684743677e-05, 1.4289167333761978e-05,
		1.6445998723288938e-23, 1.644449656153617e-23, -0.12082182130833462, 0.10071139253525001, 0.9951429498951927,
		-0.737602566559213, 0.05416394019118463, 0.05416480323717786, -0.21957414994320776, 0.18720519961800036,
		1.8826208847862704, -2.1654818122365693, 0.40977988320959974, 0.4097798832285575, -0.15025297852944694,
		0.2587312105242011, 1.1089907160751353, -0.8579175774536536, 0.4046354255504068, 0.40463542551616666,
		0.6370269899832153, 0.20841770070157362, -0.13256846750333123, -0.13256846750060416, -4.327305274737533e-06,
		-4.327305274704215e-06, -0.10509054360147614, -0.1050905545457423, 1.7028629600619483e-15, 1.702846010153668e-15,
		-8.797454965034419e-38, -8.797454965034419e-38, 0.09211718408325711, -0.3442469630110166, -0.00076658217844394,
		0.053207703781177326, -6.704733879917925e-05
	};

	double PKD_COEFFS[] = {
	    2.723706842149663, -0.07213418180646858, -0.2338759981098535, -0.16197810158378667, 0.006826977163861241,
		1.399542327204412, 0.06074570345894148, -0.5714590976020028, -2.216020728005671e-13, -0.5248042416314351,
		0.11254122374757768, -0.6311024421674895, -0.12746465868130835, -0.12269423211102584, -0.060557156254740785,
		0.03468889085914811, 0.22039081773410646, -0.14462869383466218, 0.2880309115721815, 1.2218615082497966,
		0.23014997506847226, -0.07792948126972993, -0.0073713934315941445, 0.3949004817540711, 0.1009152483555616,
		0.08471379715802323, -0.08162530710249719, 0.018864947077576803, 0.1561051401162299, 0.19132349228330042,
		-0.2940240750225567, 0.1804164276619905, -0.18178303303158194, -0.13590363360244037, 0.2504070666141272,
		0.013762901636299988, 0.21269116077906766, 0.34327248600200044, -0.6258739177914253, 0.5486780013910816,
		0.548677999906894, 0.6597666186040617, -0.2541000680767486, 1.1956577674082591, -1.2004878136712764,
		0.044248481099228895, -0.47145099031010906, 0.2102999172337559, -0.5647459114258849, -0.009512495157559019,
		-0.009513224172557117, -0.46852323556707925, 0.7814321986213926, -5.243894193408705e-10, -5.243769529758513e-10,
		0.0089617312944298, -0.0384705412359595, 0.20419010057118944, 0.037920093635765845, 1.661145310449439e-07,
		1.661145252528774e-07, 0.4583251194083408, 0.7006270256942322, -0.4391030755920558, 1.3444381466487407,
		-0.3464177999571274, -0.3466719395149742, -0.6302259839901113, 0.20853599589711275, 3.4368177871343075,
		-2.929936810714505, 0.10296438528273699, 0.102964542324215, -0.735030042462161, -0.6101941935372472,
		0.33939796935601757, -0.3144077259431008, 0.06980181818644798, 0.06980181884960658, 0.6127056965318985,
		0.36954388985833153, -0.3343721139241634, 0.9014670785136849, -0.37233388477894924, -0.3728437188372555,
		0.41100711343222796, -0.05010864525648656, 0.09600446365816508, -0.3795327248985988, 0.16570653118163603,
		0.16570421004924166, -0.30277769301558183, 0.7280101249699265, 1.0878315399716902, -1.102393376633392,
		0.1654581501755189, 0.27344650048419983, 0.5903540731461446, -0.4184049013573437, -0.29005465209042236,
		0.10086472264913175, -0.017543025991951233, -0.017560661903127155, -0.01833981569374111, -0.02184854526747984,
		-0.020548743812949164, -0.0205488296020875, 0.00011070806920246673, 0.00011070815194510691, -4.1881782118995934e-07,
		-4.185484623055985e-07, -2.157813265892783e-06, -2.1578132674202082e-06, -3.576034498999776e-15, -3.5063130230719106e-15,
		-0.14481984677372065, -0.1428621776407, -0.021663948115667474, -0.021663975639716834, -3.278749347193837e-06,
		-3.278749341861189e-06, -1.7726730519206648, -1.6433977942650622, -0.2495003381845263, -0.24950033814588915,
		0.2455147485473452, 0.24551474854734268, -0.2536650763559457, -0.1951396253911479, -0.17201829241840638,
		-0.17201851482997188, 0.004222384920370364, 0.0042223833636828995, -0.24241834806291462, -0.24101815817614497,
		0.09219336403121073, 0.09219782135175986, -3.3402330059775044e-07, -3.3402330290112747e-07, 0.29841484765056536,
		-0.4126923950598339, -1.0920568093257144, -0.3474192085434685, -0.0841522621200285, -0.08415226211986894,
		-0.8108342705203102, 0.4875755874934874, 0.48401648063133723, 0.32693242098668013, -1.5696564033065477,
		-1.569656403306552, 0.7413815843695445, -1.0528982335717558, 0.2130132109036485, -0.1964297826156994,
		-0.15438806177239886, -0.154388061772396, 1.455714019720272, -0.31228331853910507, 0.2745715764137339,
		0.27457157641814883, -0.0013499793244856205, -0.0013499793244641572, 0.009638683613206175, 0.009657361007589042,
		-2.7999460386998704e-07, -2.7999435144568133e-07, -3.207928612335217e-15, 1.4653266742127514e-15, 0.07358066587310234,
		0.6084077614013979, -0.11446239275192854, 0.14819083413194567, -0.03971427539234925, 0.04875743660816451,
		-0.011246763550514124, 0.01689435253678971, 0.0008006848328468356, 1.3995423272046263, -0.003724700328670615,
		0.20154141426278274, 1.1875423317155133e-15, 0.37700521671397985, -0.019326880899720608, 0.3699889885532407,
		-0.011515348587880213, -0.004173096930888224, -0.016393601805260526, 0.011621640735458154, 0.2203908177341122,
		-0.1446286938346999, -0.09581463226926444, -0.25285765347730166, -0.015439897715342002, 0.07900613422434939,
		-0.001882804102517803, -0.023827150630708234, 0.006021536777663797, -0.049695773052093335, -0.0816253071024814,
		-0.012824002383719186, -0.007834342119590469, -0.005044603639545921, 0.009722670035235659, -0.005650539613900286,
		0.0064355373219469455, -0.031163795107221434, 0.009772337122062647, 0.005577309654822309, -0.0238492972289923,
		-0.03779730693414541, 0.0747464739505632, -0.33245812578002404, -0.33245812602420366, -0.10375624103449999,
		-0.01592189110081856, -0.38232883690760616, 0.4251743410622873, -0.0005122353331118398, 0.0611060840595779,
		-0.007700553831682146, 0.17807322781691587, -0.036569058672092314, -0.03657021709266271, -2.0509239787111664,
		1.0056200813017142, -2.933544528881044e-19, -2.9336309368303197e-19, 0.1296341996895633, 0.0730799457231437,
		-0.10193855880339278, 0.1873403986906787, 5.621351828913298e-13, 5.621351828810036e-13, -1.1621401083080065,
		-0.5463827858317458, 0.0924313530720968, -0.6543630104815907, 0.07663171413365866, 0.07662655890532744,
		0.2573609997005186, -0.3380087980402644, -0.9265391267904207, 0.6515592714693977, -0.2595644104953285,
		-0.2595640959434415, 0.24219898386841307, 0.646696922090675, -0.13143284198696087, 0.19067406407690501,
		0.12005632950885717, 0.12005633109718195, -0.03471509724076298, -0.6746094903440347, 0.07200511448154953,
		-0.21669540345458335, 0.2106427378415061, 0.21012168650823723, 0.7554033797305796, -0.6309351390332093,
		-0.01054700731774472, 0.3399734439024471, -0.008526388581199057, -0.008526513485963332, 0.043916966070787884,
		-0.14625959329267962, -0.11206770252699184, 0.142303661573968, -0.2207197429008749, -0.04585534629598774,
		-0.03974611559613217, -0.7532438926880357, -0.03172473673023128, -0.015203439033638244, -0.0037990219192762242,
		-0.0038027091602003387, -0.11137583193941353, -0.1125081651891367, -0.002163059159977721, -0.002163058840747369,
		4.5915262418706487e-07, 4.591526241890436e-07, -2.0644393827542177e-12, -2.0617870393278435e-12, -7.116846715331988e-11,
		-7.116846715331211e-11, 0.0, 0.0, 0.10435143158161539, 0.10861474118599501,
		-0.0036050923269090097, -0.0036050923271791473, -6.199782258123893e-12, -6.199782258123893e-12, 2.5454728780766196,
		2.619245206914214, -0.2494517260989691, -0.2494517260989709, 0.03751533723776511, 0.03751533723776493,
		-0.01970100614378375, 0.26048660199389945, 0.14183905923237, 0.1418389978171785, 0.00018203608820316691,
		0.00018203595399263772, -0.2325853714604579, -0.2324717278640238, -0.07145843243406526, -0.0714584050566342,
		-1.1811390654321527e-11, -1.1811390654320864e-11, 0.07183251219379176, -0.04140545796747488, -0.20687260746226582,
		1.781241014441352, -0.11798050378096449, -0.11798050378096449, 0.15911148146804927, -0.1075842475430283,
		0.0884454516481287, -0.39894008525123476, -0.563855345055074, -0.563855345055074, -0.07630783117349134,
		0.12492437817726883, 0.1706160205118954, 0.09767991217515479, -0.20952693036882186, -0.20952693036882186,
		1.0597326434894592, -2.0684147777936355, 0.11271074356157544, 0.11271074356772683, -9.104855825021758e-06,
		-9.104855824742259e-06, 0.05066826418365238, 0.05067566761500523, -8.289686471682648e-13, -8.289671855537607e-13,
		1.1919071736398978e-43, 1.1919071736398978e-43, -0.016552618597759274, -0.157533540914637, 0.008749990627919155,
		-0.03994620039376648, -9.071850739550001e-05
	};

	double PKD_PKI_COEFFS[] = {
	    2.4486522673388285, -0.24598452619243968, 0.05130511757176623, -0.16153322673458698, 0.014383313195693461,
		0.978501492252329, 0.1688241994145971, -0.3091958213754967, -7.804798832165942e-14, -0.1943798383868832,
		0.5742473740747355, -0.5354777356131009, -0.10501093987678585, -0.18643288446138714, 0.020036594517956755,
		0.006606119601675053, -0.02601081032499976, 0.2008718456719237, 0.12742524830171875, 1.2163918058684233,
		0.1733994747099212, -0.13927291414949355, 0.008885322413196554, 0.27330178805065675, -0.14420969789042665,
		0.02417685877213724, -0.07283944180676101, -0.04272773084202273, 0.11785561895121364, 0.10581891919570571,
		-0.1655056702942756, 0.04489202032239992, -0.009036022365314481, -1.5509086306802313, 1.622355414785843,
		-0.14675611315302556, 0.4255988271897217, -0.19742652742786818, -0.0360515218426543, 0.2947243885944922,
		0.29472646279270576, 0.45428385318804165, 0.22645027161043474, 0.766566205090229, -0.6943417413971286,
		0.024314424930889905, -0.1811842235921268, 0.11612028499760009, -0.32515580260711885, 0.0791298862772229,
		0.07912971586298224, -0.37846249205809274, 0.6521358164926441, -7.464481567069533e-10, -7.464604281398276e-10,
		1.2395887284926153, 0.1721673023203285, -1.1250050800716318, 1.0231341686733364, -1.2471281984376906e-06,
		-1.2471285976492634e-06, -0.42466209559526863, -0.28723944739640705, -0.26470626943635844, 0.22407712450685555,
		-0.004007128983554029, -0.0035426448191252097, 0.05784983734241434, -0.3111584167663928, 2.1741128911642242,
		-0.9378324087778467, 0.08303232552371528, 0.08303361766044803, -0.24669404758214586, -0.17434677972441623,
		0.31803292198908667, -0.3727588210599902, -0.1053622311097906, -0.32392117157729144, 0.10249750806546547,
		0.11551021871714504, -0.27720776487601473, 0.8616311790339266, -0.047990427906647176, -0.04729195016577917,
		0.04657737861397226, 0.33958430633177167, 0.33034771058994916, -0.5725044383428733, 0.40624223982760704,
		0.40624341846375284, -0.19088701592417937, 0.4732245831329932, 0.957753701622291, -1.0506224718215478,
		0.16958644956783786, 0.16246801104778794, -0.029896127329371688, 0.1259513316600367, -0.04290495018359924,
		0.04923424368158096, -0.012362019857755407, -0.009254787900950676, -0.508290075316312, -0.49893595504840765,
		0.5728315376494885, 0.5728319324425435, 0.00013055177670773444, 0.00013054507627117284, -1.306965927761437e-05,
		-1.306928427819298e-05, -7.776525041374816e-06, -7.776522303202119e-06, 2.1155147117631825e-15, -1.7014964075823594e-15,
		0.8193457936614257, 0.6358676019758817, 0.9773596583953819, 0.9773597992727688, 1.7501089897447892e-06,
		1.7501089934016854e-06, -2.10702755673342, -1.984635910431106, -0.3641499786214214, -0.36415896001360043,
		-0.012128790556867833, -0.01212879055687249, -0.07793203415455864, -0.15375110782032556, 0.17198807038137964,
		0.18050398788171446, 0.0012338867979222023, 0.0012338277275824715, 0.002224620700772211, -0.0007214331635056748,
		-0.20489683844472992, -0.2048939764247652, -6.897838480762705e-07, -6.89783843453165e-07, -0.018791183568807376,
		-0.03404171302376923, -0.5235535727226639, -0.38199621092843183, -0.2771521339050993, -0.2771499300013723,
		0.030958788200296912, -0.28720618899521233, 0.5858901869643692, 0.24588047725715087, 0.08443777829303917,
		0.08443777707416811, 0.573410518166318, -0.8139276081110257, 0.1714665260630774, -0.0964748373095958,
		-0.17765710713328614, -0.17765710713335991, 0.32650685344421704, -0.33699039578780143, 0.20291213757355167,
		0.20291213756164853, -0.0007251437870690728, -0.0007251437869944045, -0.24562276256200877, -0.24562275887977075,
		1.2510500786068795e-09, 1.252475925035238e-09, -1.6058093415897926e-15, -1.190987482953666e-16, -0.15166648376739006,
		0.938036532171219, -0.05259820239651572, -0.010856007770728518, -0.04660761657357903, 0.0593944469269998,
		-0.030594330162619844, 0.026516185766615897, 0.00014917134735072986, 0.9785014922521927, -0.012946086512962553,
		0.15987884213139927, 8.558711576786685e-16, 0.08718056444376263, -0.07580968648810693, 0.218714252895926,
		-0.015176522402050785, 0.014876272245000733, -0.01672421845322987, 0.001168990166345591, 0.33982299232217805,
		0.2008718456718954, -0.0036455112452608235, -0.39060620862197387, -0.013678324122011004, 0.0637096993607682,
		-0.0005022918748244125, -0.01946386039998654, 0.019581537708289257, -0.06452245219598805, -0.07283944180675538,
		-0.008131527026159479, -0.008784451728253533, -0.00037286785883907926, 0.0009005736920031401, -0.0020649989709335143,
		0.0012987634831044235, 0.19457309521439725, -0.2056757692450346, 0.024066033973425677, -0.05642165585565427,
		-0.015605791146568578, 0.04300152583732522, -0.18770416277908317, -0.18770398385517467, -0.06863721770573289,
		-0.22820111562819953, -0.2610702887444023, 0.28007767479085466, -0.00020915221985068192, 0.018971478392592223,
		-0.0019488499107480147, 0.09608818421486234, 0.07240776955227102, 0.07240749905681315, -1.6764005990599669,
		0.8338148741787138, -1.9257759595971534e-16, 2.7318452384846503e-16, -0.15235181210689988, -0.5258960503277812,
		0.21855533251780515, -0.028902698541530672, -7.03297227540072e-11, -7.032972612285456e-11, -0.039431543228773624,
		0.44994297105818715, 0.08538898998155307, -0.31862015275282324, 0.20817753157425337, 0.20882570078230606,
		0.0854831830568215, -0.12224084044351076, -0.4089998958621356, -0.4539288410498358, -0.0748468310247533,
		-0.0748442202623538, 0.11140721130378217, 0.3870530765026781, -0.02664637462515242, 0.05908416647569577,
		0.41180113309694744, -0.12535210303829064, 0.07603670182683858, -0.1819365562570225, 0.07048716732423718,
		-0.24133194799388386, -0.004964610236324196, -0.004530310652879999, -0.2634224859439486, 0.5484416863487043,
		-0.03226568913993494, 0.23615726231984374, -0.24917002555960563, -0.24916685031268324, 0.033341038366989977,
		-0.106743157417885, -0.10925871204559957, 0.15064037112666492, -0.18449698583772253, -0.20104302741497448,
		0.012929158120076722, 0.47407106360834955, -0.18117643772009556, 0.10796602603070402, -0.0011394442435369103,
		-0.0004897974655589327, 0.16072807556144023, 0.16833471300004016, 0.1416756345852066, 0.14167563384568457,
		-1.828023578907615e-07, -1.8280239103643535e-07, -2.4373947002057552e-09, -2.4373663630118636e-09, -3.3390044475559266e-10,
		-3.339004441142211e-10, 0.0, 0.0, -0.2147264396106246, -0.6411465564723839,
		0.43568232521083194, 0.43568232645104094, 3.679588461798513e-11, 3.679588461798102e-11, 2.087206274084753,
		2.146202962874897, -0.36987641810244914, -0.36987649021439817, 0.002204180724947553, 0.0022041807249475326,
		0.10190152381216325, -0.13535296095016844, -0.11563916700698192, -0.08418022872198841, 5.3799590606883e-05,
		5.379955089785973e-05, -0.08426106397211888, -0.08547053425421872, -0.17501590609458584, -0.17501588451545363,
		-7.363340507652429e-12, -7.36334050765388e-12, 0.03712871717833137, -0.013773426922937176, 0.23319479874083776,
		0.45698022409277167, -0.25004295567896384, -0.2500427907395211, -0.01243389020134616, 0.010937220528790762,
		0.2608051067371816, -0.7318290565670938, -0.037312081707575176, -0.037312081732122415, -0.07826244187702423,
		0.13582290494027607, 0.5138600956290079, -0.4175032977957263, -0.2197836268077416, -0.21978362680762123,
		0.6965450012801272, -0.8211333484601588, 0.14504480145913454, 0.1450448014556497, -4.572807968153982e-06,
		-4.572807968027668e-06, -0.03757559626010509, -0.037575555604908245, 3.5502332492067966e-14, 3.550228284820615e-14,
		1.3362144082332364e-36, 1.3362144082332364e-36, 0.033831670488696564, -0.31011089610445625, -0.0007514816095986254,
		0.01277664167021136, -8.220473908993829e-05
	};
}


double GRAIL::BindingAffinityCalculator::operator()(const Math::DVector& grail_descr, AffinityMeasure measure) const
{
	const double* coeffs;
	
	switch (measure) {

		case PKD:
			coeffs = PKD_COEFFS;
			break;

		case PKI:
			coeffs = PKI_COEFFS;
			break;

		case PKD_PKI:
			coeffs = PKD_PKI_COEFFS;
			break;

		default:
			return 0.0;
	}

	double aff = *(coeffs++);

	for (std::size_t i = 0; i < GRAILDescriptorCalculator::TOTAL_DESCRIPTOR_SIZE; i++) {
		double de = grail_descr(i);
		
		aff += de * (coeffs[i] + coeffs[i + GRAILDescriptorCalculator::TOTAL_DESCRIPTOR_SIZE] * de);
	}
	
    return aff;
}
